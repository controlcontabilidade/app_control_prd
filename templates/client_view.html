{% extends "base.html" %}

{% block title %}{{ client.nomeEmpresa }} - Detalhes{% endblock %}

{% block content %}
<div class="page-header d-flex justify-content-between align-items-center">
    <div>
        <h1>
            <i class="bi bi-eye me-3"></i>
            {{ client.nomeEmpresa }}
        </h1>
        <p class="text-muted mb-0">
            {% if client.nomeFantasiaReceita and client.nomeFantasiaReceita != client.nomeEmpresa %}
                {{ client.nomeFantasiaReceita }}
            {% else %}
                Visualizar informações completas do cliente
            {% endif %}
        </p>
    </div>
    <div class="d-flex gap-2">
        {% if client.ativo %}
            <span class="badge bg-success fs-6 px-3 py-2">
                <i class="bi bi-check-circle-fill me-1"></i>CLIENTE ATIVO
            </span>
        {% else %}
            <span class="badge bg-danger fs-6 px-3 py-2">
                <i class="bi bi-x-circle-fill me-1"></i>Cliente Inativo
            </span>
        {% endif %}
        <a href="/client/{{ client.id }}/edit" class="btn btn-warning">
            <i class="bi bi-pencil me-2"></i>Editar
        </a>
        <a href="/" class="btn btn-secondary">
            <i class="bi bi-arrow-left me-2"></i>Voltar
        </a>
    </div>
</div>

<!-- Informações Básicas -->
<div class="row">
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-building me-2 text-primary"></i>
                    Informações Básicas
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">ID do Cliente</label>
                            <p class="mb-0"><code>#{{ client.id }}</code></p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">NOME DA EMPRESA</label>
                            <p class="mb-0 text-primary fw-medium">{{ client.nomeEmpresa }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">Razão Social</label>
                            <p class="mb-0">{{ client.razaoSocialReceita or 'Não informado' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">Nome Fantasia</label>
                            <p class="mb-0">{{ client.nomeFantasiaReceita or 'Não informado' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">CNPJ</label>
                            <p class="mb-0">
                                {% if client.cnpj %}
                                    <code>{{ client.cnpj }}</code>
                                {% else %}
                                    Não informado
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">INSCRIÇÃO ESTADUAL</label>
                            <p class="mb-0">{{ client.inscEst or 'Não informada' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">INSCRIÇÃO MUNICIPAL</label>
                            <p class="mb-0">{{ client.inscMun or 'Não informada' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">SEGMENTO</label>
                            <p class="mb-0">{{ client.segmento or 'Não informado' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">ATIVIDADE</label>
                            <p class="mb-0">{{ client.atividade or 'Não informada' }}</p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">Tributação</label>
                            <p class="mb-0">
                                <span class="badge bg-primary fs-6">{{ client.tributacao or 'SIMPLES' }}</span>
                            </p>
                        </div>
                        <div class="info-item mb-3">
                            <label class="fw-bold text-muted">CIDADE</label>
                            <p class="mb-0">
                                <i class="bi bi-geo-alt me-1"></i>{{ client.cidade or 'Não informada' }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Serviços Contratados -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="bi bi-tags me-2 text-primary"></i>
                    Serviços Contratados
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div class="service-card p-3 rounded {% if client.ct %}bg-success bg-opacity-10 border border-success{% else %}bg-light border{% endif %}">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-calculator-fill fs-4 me-3 {% if client.ct %}text-success{% else %}text-muted{% endif %}"></i>
                                <div>
                                    <h6 class="mb-1">Contábil (CT)</h6>
                                    <span class="badge {% if client.ct %}bg-success{% else %}bg-secondary{% endif %}">
                                        {% if client.ct %}Ativo{% else %}Inativo{% endif %}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="service-card p-3 rounded {% if client.fs %}bg-info bg-opacity-10 border border-info{% else %}bg-light border{% endif %}">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-file-earmark-text-fill fs-4 me-3 {% if client.fs %}text-info{% else %}text-muted{% endif %}"></i>
                                <div>
                                    <h6 class="mb-1">Fiscal (FS)</h6>
                                    <span class="badge {% if client.fs %}bg-info{% else %}bg-secondary{% endif %}">
                                        {% if client.fs %}Ativo{% else %}Inativo{% endif %}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="service-card p-3 rounded {% if client.dp %}bg-warning bg-opacity-10 border border-warning{% else %}bg-light border{% endif %}">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-people-fill fs-4 me-3 {% if client.dp %}text-warning{% else %}text-muted{% endif %}"></i>
                                <div>
                                    <h6 class="mb-1">Departamento Pessoal (DP)</h6>
                                    <span class="badge {% if client.dp %}bg-warning{% else %}bg-secondary{% endif %}">
                                        {% if client.dp %}Ativo{% else %}Inativo{% endif %}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                <div class="row">
                    <div class="col-md-4">
                        <p><strong>CT (Contábil):</strong> 
                            {% if client.ct %}
                                <span class="badge bg-success">Ativo</span>
                            {% else %}
                                <span class="badge bg-secondary">Inativo</span>
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4">
                        <p><strong>FS (Fiscal):</strong> 
                            {% if client.fs %}
                                <span class="badge bg-success">Ativo</span>
                            {% else %}
                                <span class="badge bg-secondary">Inativo</span>
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4">
                        <p><strong>DP (Depto. Pessoal):</strong> 
                            {% if client.dp %}
                                <span class="badge bg-success">Ativo</span>
                            {% else %}
                                <span class="badge bg-secondary">Inativo</span>
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Códigos e Sistemas -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Códigos e Sistemas</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>CÓDIGO FORTES CT:</strong> {{ client.codFortesCt or '-' }}</p>
                        <p><strong>CÓDIGO FORTES FS:</strong> {{ client.codFortesFs or '-' }}</p>
                        <p><strong>CÓDIGO FORTES PS:</strong> {{ client.codFortesPs or '-' }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>CÓDIGO DOMÍNIO:</strong> {{ client.codDominio or '-' }}</p>
                        <p><strong>SISTEMA UTILIZADO:</strong> {{ client.sistemaUtilizado or '-' }}</p>
                        <p><strong>MÓDULO SPED TRIER:</strong> {{ client.moduloSpedTrier or '-' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contatos -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Contatos</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>RESPONSÁVEL IMEDIATO:</strong> {{ client.responsavelImediato or 'Não informado' }}</p>
                        <p><strong>Telefone Fixo:</strong> {{ client.telefoneFixo or 'Não informado' }}</p>
                        <p><strong>Telefone Celular:</strong> {{ client.telefoneCelular or 'Não informado' }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>E-mail do Gestor:</strong> {{ client.emailGestor or 'Não informado' }}</p>
                        <p><strong>E-MAILS DOS SÓCIOS:</strong> {{ client.emailsSocio or 'Não informado' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sócios -->
        {% if client.socio1 or client.socio2 or client.socio3 %}
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Sócios</h5>
            </div>
            <div class="card-body">
                {% if client.socio1 %}<p><strong>Sócio 1:</strong> {{ client.socio1 }}</p>{% endif %}
                {% if client.socio2 %}<p><strong>Sócio 2:</strong> {{ client.socio2 }}</p>{% endif %}
                {% if client.socio3 %}<p><strong>Sócio 3:</strong> {{ client.socio3 }}</p>{% endif %}
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Sidebar com informações adicionais -->
    <div class="col-lg-4">
        <!-- Status -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Status</h5>
            </div>
            <div class="card-body">
                <p><strong>Cliente:</strong> 
                    {% if client.ativo %}
                        <span class="badge bg-success">Ativo</span>
                    {% else %}
                        <span class="badge bg-danger">Inativo</span>
                    {% endif %}
                </p>
                <p><strong>Integrado Domínio:</strong> 
                    {% if client.integradoDominio %}
                        <span class="badge bg-success">Sim</span>
                    {% else %}
                        <span class="badge bg-secondary">Não</span>
                    {% endif %}
                </p>
                <p><strong>Portal do Cliente:</strong> 
                    {% if client.portalCliente %}
                        <span class="badge bg-success">Ativo</span>
                    {% else %}
                        <span class="badge bg-secondary">Inativo</span>
                    {% endif %}
                </p>
                <p><strong>TAREFAS VINCULADAS:</strong> {{ client.tarefasVinculadas or 0 }}</p>
            </div>
        </div>

        <!-- Acessos Principais -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Acessos Principais</h5>
            </div>
            <div class="card-body">
                <p><strong>Código Acesso Simples:</strong> {{ client.codAcessoSimples or '-' }}</p>
                <p><strong>CPF/CNPJ (Acesso):</strong> {{ client.cpfOuCnpj or '-' }}</p>
                <p><strong>Acesso EmpWeb:</strong> {{ client.acessoEmpWeb or '-' }}</p>
            </div>
        </div>

        <!-- Órgãos -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Órgãos Reguladores</h5>
            </div>
            <div class="card-body">
                <p><strong>ANVISA GESTOR:</strong> {{ client.anvisaGestor or '-' }}</p>
                <p><strong>ANVISA EMPRESA:</strong> {{ client.anvisaEmpresa or '-' }}</p>
                <p><strong>IBAMA:</strong> {{ client.acessoIbama or '-' }}</p>
                <p><strong>SEMACE:</strong> {{ client.acessoSemace or '-' }}</p>
            </div>
        </div>

        <!-- Informações do Sistema -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Informações do Sistema</h5>
            </div>
            <div class="card-body">
                {% if client.criadoEm %}
                <p><strong>Criado em:</strong> 
                    {{ client.criadoEm|format_date if client.criadoEm else 'Não informado' }}
                </p>
                {% endif %}
                {% if client.mesAnoInicio %}
                <p><strong>Início dos Serviços:</strong> {{ client.mesAnoInicio }}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Seção expansível de detalhes técnicos -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">
            <button class="btn btn-link" type="button" data-bs-toggle="collapse" data-bs-target="#detailsCollapse">
                Detalhes Técnicos e Acessos Completos
            </button>
        </h5>
    </div>
    <div id="detailsCollapse" class="collapse">
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h6>Acessos Municipais</h6>
                    <p><strong>ISS:</strong> {{ client.acessoIss or '-' }}</p>
                    <p><strong>SEFIN:</strong> {{ client.acessoSefin or '-' }}</p>
                    <p><strong>SEUMA:</strong> {{ client.acessoSeuma or '-' }}</p>
                    
                    <h6 class="mt-3">Acessos Federais</h6>
                    <p><strong>FAP/INSS:</strong> {{ client.acessoFapInss or '-' }}</p>
                    <p><strong>CRF:</strong> {{ client.acessoCrf or '-' }}</p>
                </div>
                <div class="col-md-6">
                    <h6>Procurações</h6>
                    <p><strong>Procuração RC:</strong> {{ client.procRc or '-' }}</p>
                    <p><strong>Procuração CX:</strong> {{ client.procCx or '-' }}</p>
                    <p><strong>Procuração SW:</strong> {{ client.procSw or '-' }}</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

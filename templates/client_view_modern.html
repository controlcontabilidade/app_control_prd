{% extends "base.html" %}

{% block title %}{{ client.nomeEmpresa }} - SIGEC{% endblock %}

{% block content %}
<!-- Header da página -->
<div class="page-header">
    <div class="row align-items-center">
        <div class="col-md-8">
            <h1>
                <i class="bi bi-eye" style="color: var(--control-primary);"></i>
                {{ client.nomeEmpresa }}
            </h1>
            <p class="mb-2">
                {% if client.nomeFantasiaReceita and client.nomeFantasiaReceita != client.nomeEmpresa %}
                    <str                <h5 class="mb-0">
                    <i class="fas fa-comments me-2"></i>
                    Observações e Dados Adicionais
                </h5>Nome Fantasia:</strong> {{ client.nomeFantasiaReceita }}
                {% else %}
                    SIGEC - Sistema de Gestão de Empresas Control - Visualização completa do cliente
                {% endif %}
            </p>
            <div class="d-flex gap-2 align-items-center">
                {% set status = client.get('statusCliente', 'ativo')|lower %}
                {% if status == 'ativo' %}
                    <span class="status-indicator">
                        <span class="status-dot active"></span>
                        <strong class="text-success">Cliente Ativo</strong>
                    </span>
                {% else %}
                    <span class="status-indicator">
                        <span class="status-dot inactive"></span>
                        <strong class="text-muted">Cliente Inativo</strong>
                    </span>
                {% endif %}
                {% if client.cnpj %}
                    <span class="text-muted">•</span>
                    <code class="text-muted user-select-all">{{ client.cnpj | only_numbers }}</code>
                {% endif %}
                {% if client.cidade %}
                    <span class="text-muted">•</span>
                    <span class="text-muted">{{ client.cidade }}</span>
                {% endif %}
            </div>
        </div>
        <div class="col-md-4 text-end">
            <a href="/client/{{ client.id }}/edit" class="btn btn-primary me-2">
                <i class="bi bi-pencil"></i>
                Editar
            </a>
            <a href="/" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i>
                Voltar
            </a>
        </div>
    </div>
</div>

<div class="row">
    <!-- Coluna principal - 8 colunas -->
    <div class="col-lg-8">
        <!-- Bloco 1: Informações da Pessoa Física / Jurídica -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-user-tie me-2"></i>
                    Informações da Pessoa Física / Jurídica
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">nome da empresa</label>
                        <p class="mb-0"><strong>{{ client.nomeEmpresa or '-' }}</strong></p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">razão social (receita)</label>
                        <p class="mb-0">{{ client.razaoSocialReceita or '-' }}</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Nome Fantasia (Receita)</label>
                        <p class="mb-0">{{ client.nomeFantasiaReceita or '-' }}</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">cpf/cnpj</label>
                        <p class="mb-0">
                            {% if client.cpfCnpj or client.cnpj %}
                                <code class="user-select-all">{{ (client.cpfCnpj or client.cnpj) | only_numbers }}</code>
                                <small class="text-muted d-block">Apenas números - fácil para copiar</small>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Perfil do Cliente</label>
                        <p class="mb-0">
                            {% set perfil_val = client.perfil or client.perfilCliente %}
                            {% if perfil_val %}
                                <span class="badge bg-info">{{ perfil_val }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Inscrição Estadual</label>
                        <p class="mb-0">{{ client.inscEst or '-' }}</p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Inscrição Municipal</label>
                        <p class="mb-0">{{ client.inscMun or '-' }}</p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Estado</label>
                        <p class="mb-0">
                            {% if client.estado %}
                                <span class="badge bg-primary">{{ client.estado }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Cidade</label>
                        <p class="mb-0">{{ client.cidade or '-' }}</p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Regime Federal</label>
                        <p class="mb-0">
                            {% if client.regimeFederal or client.tributacao %}
                                <span class="badge bg-secondary">{{ client.regimeFederal or client.tributacao }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">Regime Estadual</label>
                        <p class="mb-0">
                            {% if client.regimeEstadual %}
                                <span class="badge bg-secondary">{{ client.regimeEstadual }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Segmento</label>
                        <p class="mb-0">{{ client.segmento or '-' }}</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Atividade Principal</label>
                        <p class="mb-0">{{ client.atividade or '-' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bloco 2: Serviços Prestados pela Control -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-handshake me-2"></i>
                    Serviços Prestados pela Control
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Indicadores específicos -->
                    <div class="col-md-3 mb-3">
                        <label class="form-label text-muted">Doméstica</label>
                        <p class="mb-0">
                            {% if client.domestica %}
                                <span class="badge bg-secondary">{{ client.domestica }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label class="form-label text-muted">Gera arquivo do Sped</label>
                        <p class="mb-0">
                            {% if client.geraArquivoSped %}
                                <span class="badge bg-secondary">{{ client.geraArquivoSped }}</span>
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-12 mb-3">
                        <label class="form-label text-muted">Serviços Contratados</label>
                        <div class="d-flex gap-2 flex-wrap">
                            {% if client.bpoFinanceiro %}
                                <span class="badge bg-info">
                                    <i class="bi bi-graph-up me-1"></i>BPO Financeiro
                                </span>
                            {% endif %}
                            {% if client.ct %}
                                <span class="badge bg-primary">
                                    <i class="bi bi-calculator me-1"></i>Departamento Contábil (CT)
                                </span>
                            {% endif %}
                            {% if client.fs %}
                                <span class="badge bg-success">
                                    <i class="bi bi-file-text me-1"></i>Departamento Fiscal (FS)
                                </span>
                            {% endif %}
                            {% if client.dp %}
                                <span class="badge bg-warning">
                                    <i class="bi bi-people me-1"></i>Departamento Pessoal (DP)
                                </span>
                            {% endif %}
                            {% if not client.bpoFinanceiro and not client.ct and not client.fs and not client.dp %}
                                <span class="text-muted">Nenhum serviço contratado</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Data de Início dos Serviços</label>
                        <p class="mb-0">
                            {% if client.dataInicioServicos or client.mesAnoInicio %}
                                <i class="bi bi-calendar-event me-1"></i>
                                {{ (client.dataInicioServicos or client.mesAnoInicio)|format_date }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>

                    <!-- Códigos dos Sistemas -->
                    <div class="col-12 mb-3">
                        <label class="form-label text-muted">Códigos dos Sistemas</label>
                        <div class="row">
                            <div class="col-md-3 mb-2">
                                <small class="text-muted d-block">CÓD. DOMÍNIO</small>
                                <p class="mb-0">
                                    {% if client.codDominio %}
                                        <code class="user-select-all">{{ client.codDominio }}</code>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-3 mb-2">
                                <small class="text-muted d-block">CÓD. FORTES CT</small>
                                <p class="mb-0">
                                    {% if client.codFortesCt %}
                                        <code class="user-select-all">{{ client.codFortesCt }}</code>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-3 mb-2">
                                <small class="text-muted d-block">CÓD. FORTES FS</small>
                                <p class="mb-0">
                                    {% if client.codFortesFs %}
                                        <code class="user-select-all">{{ client.codFortesFs }}</code>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-3 mb-2">
                                <small class="text-muted d-block">CÓD. FORTES PS</small>
                                <p class="mb-0">
                                    {% if client.codFortesPs %}
                                        <code class="user-select-all">{{ client.codFortesPs }}</code>
                                    {% else %}
                                        <span class="text-muted">-</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Sistema e Módulos -->
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Sistema Utilizado</label>
                        <p class="mb-0">
                            {% if client.sistemaUtilizado %}
                                <i class="bi bi-pc-display me-1"></i>
                                {{ client.sistemaUtilizado }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Módulo SPED TRIER</label>
                        <p class="mb-0">
                            {% if client.moduloSpedTrier %}
                                <i class="bi bi-puzzle me-1"></i>
                                {{ client.moduloSpedTrier }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bloco 3: Quadro Societário -->
    <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-users me-2"></i>
                    Quadro Societário
                </h5>
            </div>
            <div class="card-body">
                {% set found_socio = false %}
                {% for i in range(1, 11) %}
                    {% set socio_nome = client.get('socio' + i|string + '_nome') %}
                    {% if socio_nome %}
                        {% set found_socio = true %}
                        <div class="row mb-3">
                            <div class="col-12">
                                <h6 class="text-primary">
                                    <i class="fas fa-user me-2"></i>
                                    Sócio {{ i }}
                                </h6>
                            </div>
                            <div class="col-md-6 mb-2">
                                <label class="form-label text-muted">Nome</label>
                                <p class="mb-0"><strong>{{ socio_nome }}</strong></p>
                            </div>
                            <div class="col-md-6 mb-2">
                                <label class="form-label text-muted">CPF</label>
                                <p class="mb-0">
                                    {% set socio_cpf = client.get('socio' + i|string + '_cpf') %}
                                    {% if socio_cpf %}
                                        <code>{{ socio_cpf }}</code>
                                    {% set found_socio = false %}
                                    {% for i in range(1, 5) %}
                                        {% set socio_nome = client.get('socio_' ~ i ~ '_nome') %}
                                </p>
                            </div>
                            <div class="col-md-4 mb-2">
                                <label class="form-label text-muted">Data Nascimento</label>
                                <p class="mb-0">{{ client.get('socio' + i|string + '_dataNascimento') or '-' }}</p>
                            </div>
                            <div class="col-md-4 mb-2">
                                <label class="form-label text-muted">Administrador</label>
                                <p class="mb-0">
                                    {% set socio_admin = client.get('socio' + i|string + '_administrador') %}
                                    {% if socio_admin %}
                                        <span class="badge bg-success">{{ socio_admin }}</span>
                                    {% else %}
                                        -
                                    {% endif %}
                                </p>
                                                        {% set socio_cpf = client.get('socio_' ~ i ~ '_cpf') %}
                            <div class="col-md-4 mb-2">
                                                            <code class="user-select-all">{{ socio_cpf | only_numbers }}</code>
                                <p class="mb-0">{{ client.get('socio' + i|string + '_cotas') or '-' }}</p>
                            </div>
                        </div>
                        {% if not loop.last %}<hr>{% endif %}
                    {% endif %}
                                                <div class="col-md-4 mb-2">
                                                    <label class="form-label text-muted">Data Nascimento</label>
                                                    <p class="mb-0">{{ client.get('socio_' ~ i ~ '_data_nascimento') or client.get('socio_' ~ i ~ '_dataNascimento') or '-' }}</p>
                                                </div>
                                                <div class="col-md-4 mb-2">
                                                    <label class="form-label text-muted">Administrador</label>
                                                    <p class="mb-0">
                                                        {% set socio_admin = client.get('socio_' ~ i ~ '_administrador') %}
                                                        {% if socio_admin %}
                                                            <span class="badge bg-success">{{ socio_admin }}</span>
                                                        {% else %}
                                                            -
                                                        {% endif %}
                                                    </p>
                                                </div>
                                                <div class="col-md-4 mb-2">
                                                    <label class="form-label text-muted">% Participação</label>
                                                    <p class="mb-0">{{ client.get('socio_' ~ i ~ '_participacao') or '-' }}</p>
                                                </div>
                                                {% if client.get('socio_' ~ i ~ '_email') or client.get('socio_' ~ i ~ '_telefone') %}
                                                <div class="col-md-6 mb-2">
                                                    <label class="form-label text-muted">E-mail</label>
                                                    <p class="mb-0">{{ client.get('socio_' ~ i ~ '_email') or '-' }}</p>
                                                </div>
                                                <div class="col-md-6 mb-2">
                                                    <label class="form-label text-muted">Telefone</label>
                                                    <p class="mb-0">{{ client.get('socio_' ~ i ~ '_telefone') or '-' }}</p>
                                                </div>
                                                {% endif %}
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">telefone fixo</label>
                        <p class="mb-0">
                            {% if client.telefoneFixo %}
                                <i class="bi bi-telephone me-1"></i>{{ client.telefoneFixo }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">telefone celular</label>
                        <p class="mb-0">
                            {% if client.telefoneCelular %}
                                <i class="bi bi-phone me-1"></i>{{ client.telefoneCelular }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label class="form-label text-muted">WhatsApp</label>
                        <p class="mb-0">
                            {% if client.whatsapp %}
                                <i class="bi bi-whatsapp me-1"></i>{{ client.whatsapp }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">e-mail principal</label>
                        <p class="mb-0">
                            {% if client.emailPrincipal %}
                                <i class="bi bi-envelope me-1"></i>{{ client.emailPrincipal }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">e-mail secundário</label>
                        <p class="mb-0">
                            {% if client.emailSecundario %}
                                <i class="bi bi-envelope me-1"></i>{{ client.emailSecundario }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-12 mb-3">
                        <label class="form-label text-muted">Responsável Imediato</label>
                        <p class="mb-0">
                            {% if client.responsavelImediato %}
                                <i class="bi bi-person-badge me-1"></i>{{ client.responsavelImediato }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bloco 5: Senhas e Credenciais -->
        <div class="card mb-4">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">
                    <i class="fas fa-key me-2"></i>
                    Senhas
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>Informações Sensíveis</strong> - Dados de acesso confidenciais
                </div>
                <div class="row">
                    {% set credenciais = [
                        ('ISS', client.acessoIss),
                        ('SEFIN', client.acessoSefin),
                        ('SEUMA', client.acessoSeuma),
                        ('EmpWeb', client.acessoEmpWeb),
                        ('FAP/INSS', client.acessoFapInss),
                        ('CRF', client.acessoCrf),
                        ('IBAMA', client.acessoIbama),
                        ('SEMACE', client.acessoSemace)
                    ] %}
                    {% for nome, acesso in credenciais %}
                        {% if acesso %}
                            <div class="col-md-6 mb-2">
                                <label class="form-label text-muted">{{ nome }}</label>
                                <p class="mb-0">
                                    <i class="fas fa-user me-1"></i>{{ acesso }}
                                    <i class="fas fa-eye-slash ms-2 text-muted" title="Senha oculta por segurança"></i>
                                </p>
                            </div>
                        {% endif %}
                    {% endfor %}
                    {% if not (client.acessoIss or client.acessoSefin or client.acessoSeuma or client.acessoEmpWeb or client.acessoFapInss or client.acessoCrf or client.acessoIbama or client.acessoSemace) %}
                        <div class="col-12">
                            <p class="text-muted text-center">
                                <i class="fas fa-info-circle me-2"></i>
                                Nenhuma credencial cadastrada
                            </p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Bloco 6: Procurações -->
        <div class="card mb-4">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0">
                    <i class="fas fa-file-contract me-2"></i>
                    Procurações
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% set procuracoes = [
                        ('RFB (Receita Federal)', client.procRfb, client.procRfbData),
                        ('Receita Estadual', client.procRc, client.procRcData),
                        ('Caixa Econômica', client.procCx, client.procCxData),
                        ('Previdência Social', client.procSw, client.procSwData),
                        ('Municipal', client.procMunicipal, client.procMunicipalData)
                    ] %}
                    {% for nome, ativa, data in procuracoes %}
                        {% if ativa %}
                            <div class="col-md-6 mb-3">
                                <label class="form-label text-muted">{{ nome }}</label>
                                <p class="mb-0">
                                    <span class="badge bg-success me-2">
                                        <i class="fas fa-check me-1"></i>Ativa
                                    </span>
                                    {% if data %}
                                        <small class="text-muted">{{ data }}</small>
                                    {% endif %}
                                </p>
                            </div>
                        {% endif %}
                    {% endfor %}
                    {% if not (client.procRfb or client.procRc or client.procCx or client.procSw or client.procMunicipal) %}
                        <div class="col-12">
                            <p class="text-muted text-center">
                                <i class="fas fa-info-circle me-2"></i>
                                Nenhuma procuração cadastrada
                            </p>
                        </div>
                    {% endif %}
                </div>
                {% if client.outrasProc %}
                    <div class="row mt-3">
                        <div class="col-12">
                            <label class="form-label text-muted">Outras Procurações</label>
                            <p class="mb-0">{{ client.outrasProc }}</p>
                        </div>
                    </div>
                {% endif %}
                {% if client.obsProcuracoes %}
                    <div class="row mt-3">
                        <div class="col-12">
                            <label class="form-label text-muted">Observações sobre Procurações</label>
                            <p class="mb-0">{{ client.obsProcuracoes }}</p>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Bloco 7: Observações e Dados Adicionais -->
        <div class="card mb-4">
            <div class="card-header bg-light text-dark">
                <h5 class="mb-0">
                    <i class="fas fa-sticky-note me-2"></i>
                    Bloco 7 - Observações e Dados Adicionais
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Status do Cliente</label>
                        <p class="mb-0">
                            {% set status = client.get('statusCliente', 'ativo')|lower %}
                            {% if status == 'ativo' %}
                                <span class="badge bg-success">
                                    <i class="fas fa-check-circle me-1"></i>Ativo
                                </span>
                            {% else %}
                                <span class="badge bg-secondary">
                                    <i class="fas fa-pause-circle me-1"></i>Inativo
                                </span>
                            {% endif %}
                        </p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-muted">Última Atualização</label>
                        <p class="mb-0">
                            {% if client.ultimaAtualizacao %}
                                <i class="fas fa-clock me-1"></i>{{ client.ultimaAtualizacao|format_datetime }}
                            {% else %}
                                -
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coluna lateral direita - 4 colunas -->
    <div class="col-lg-4">
        <!-- Painel de Acesso Rápido (Novo Layout) -->
        <div class="card mb-4">
            <div class="card-header bg-light border-0">
                <h5 class="mb-0 fw-bold">Acesso Rápido</h5>
            </div>
            <div class="card-body">
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cliente Ativo:</span>
                    {% set status = client.get('statusCliente', 'ativo')|lower %}
                    <span class="fw-bold text-{{ 'success' if status == 'ativo' else 'danger' }}">{{ 'SIM' if status == 'ativo' else 'NÃO' }}</span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cliente desde:</span>
                    <span class="fw-bold">
                        {% if client.dataInicioServicos or client.mesAnoInicio %}
                            {{ (client.dataInicioServicos or client.mesAnoInicio)|format_date }}
                        {% else %}-{% endif %}
                    </span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Perfil do Cliente:</span>
                    {% set perfil_val = client.perfil or client.perfilCliente %}
                    <span class="fw-bold text-info">{{ perfil_val or '-' }}</span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Serviços:</span>
                    <span>
                        {% if client.ct %}<span class="badge bg-success px-3">CT</span>{% endif %}
                        {% if client.fs %}<span class="badge bg-success px-3">FS</span>{% endif %}
                        {% if client.dp %}<span class="badge bg-success px-3">DP</span>{% endif %}
                    </span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Doméstica:</span>
                    <span>{% if client.domestica %}<span class="badge bg-warning text-white px-3">SIM</span>{% else %}<span class="badge bg-warning text-white px-3">NÃO</span>{% endif %}</span>
                </div>
                <hr />
                <div class="mb-2 fw-bold text-muted">Códigos nos Sistemas:</div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cód. Domínio:</span>
                    <span class="fw-bold" style="color:#e83e8c;">{{ client.codDominio or '-' }}</span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cód. Fortes CT:</span>
                    <span class="fw-bold" style="color:#e83e8c;">{{ client.codFortesCt or '-' }}</span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cód. Fortes FS:</span>
                    <span class="fw-bold" style="color:#e83e8c;">{{ client.codFortesFs or '-' }}</span>
                </div>
                <div class="mb-2 d-flex justify-content-between align-items-center">
                    <span class="text-muted">Cód. Fortes PS:</span>
                    <span class="fw-bold" style="color:#e83e8c;">{{ client.codFortesPs or '-' }}</span>
                </div>
            </div>
        </div>

        <!-- Ações Rápidas -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-bolt me-2"></i>
                    Ações Rápidas
                </h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <!-- 1. Ver Reuniões -->
                    <a href="/client/{{ client.id }}/meetings" class="btn btn-outline-info">
                        <i class="fas fa-calendar-alt me-2"></i>
                        Ver Reuniões
                    </a>
                    
                    <!-- 2. Registrar Reuniões -->
                    <a href="/client/{{ client.id }}/meeting" class="btn btn-info">
                        <i class="fas fa-calendar-plus me-2"></i>
                        Registrar Reunião
                    </a>
                    
                    <!-- 3. Editar Cliente -->
                    <a href="/client/{{ client.id }}/edit" class="btn btn-primary">
                        <i class="fas fa-edit me-2"></i>
                        Editar Cliente
                    </a>
                    
                    <!-- 4. Excluir Cliente -->
                    {% if session.user_perfil and session.user_perfil.lower() == 'administrador' %}
                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">
                            <i class="fas fa-trash me-2"></i>
                            Excluir Cliente
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Serviços Contratados -->
        <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">
                    <i class="fas fa-briefcase me-2"></i>
                    Serviços Contratados
                </h5>
            </div>
            <div class="card-body">
                <div class="service-badges">
                    {% if client.bpoFinanceiro %}
                        <span class="badge bg-info mb-2 w-100 p-2">
                            <i class="bi bi-graph-up me-1"></i>BPO Financeiro
                        </span>
                    {% endif %}
                    {% if client.ct %}
                        <span class="badge bg-primary mb-2 w-100 p-2">
                            <i class="bi bi-calculator me-1"></i>Contábil (CT)
                        </span>
                    {% endif %}
                    {% if client.fs %}
                        <span class="badge bg-success mb-2 w-100 p-2">
                            <i class="bi bi-file-text me-1"></i>Fiscal (FS)
                        </span>
                    {% endif %}
                    {% if client.dp %}
                        <span class="badge bg-warning mb-2 w-100 p-2">
                            <i class="bi bi-people me-1"></i>Pessoal (DP)
                        </span>
                    {% endif %}
                    {% if not client.bpoFinanceiro and not client.ct and not client.fs and not client.dp %}
                        <p class="text-muted text-center mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            Nenhum serviço contratado
                        </p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Confirmação de Exclusão -->
{% if session.user_perfil and session.user_perfil.lower() == 'administrador' %}
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="deleteModalLabel">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Confirmar Exclusão
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-danger d-flex align-items-center" role="alert">
                    <i class="fas fa-exclamation-triangle me-3"></i>
                    <div>
                        <strong>Atenção!</strong> Esta ação não pode ser desfeita.
                    </div>
                </div>
                <p>Tem certeza que deseja excluir o cliente <strong>{{ client.nomeEmpresa }}</strong>?</p>
                <p class="text-muted">Todos os dados relacionados a este cliente serão permanentemente removidos.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-2"></i>
                    Cancelar
                </button>
                <form method="POST" action="/client/{{ client.id }}/delete" style="display: inline;">
                    <button type="submit" class="btn btn-danger">
                        <i class="fas fa-trash me-2"></i>
                        Confirmar Exclusão
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endif %}

<style>
.status-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
}

.status-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    display: inline-block;
}

.status-dot.active {
    background-color: #28a745;
    box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2);
}

.status-dot.inactive {
    background-color: #6c757d;
    box-shadow: 0 0 0 3px rgba(108, 117, 125, 0.2);
}

.quick-info .info-item {
    padding: 8px 0;
    border-bottom: 1px solid #f8f9fa;
}

.quick-info .info-item:last-child {
    border-bottom: none;
}

.service-badges .badge {
    font-size: 0.9rem;
}

/* Facilitador de cópia - CPF/CNPJ */
.user-select-all {
    user-select: all;
    cursor: pointer;
    border: 1px solid transparent;
    padding: 2px 4px;
    border-radius: 3px;
    transition: all 0.2s ease;
}

.user-select-all:hover {
    background-color: #e3f2fd;
    border-color: #2196f3;
}

@media (max-width: 991px) {
    .col-lg-4 {
        margin-top: 2rem;
    }
}
</style>

{% endblock %}
